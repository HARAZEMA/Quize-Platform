<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Quizzes - QuizHub</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<!-- Navbar -->
<nav>
  <a href="index.html">Home</a>
  <a href="myquiz.html">My Quizzes</a>
  <a href="global.html">Global Quizzes</a>
  <a href="profile.html">Profile</a>
  <a href="community.html">Community</a>
</nav>

<div class="container">
  <h2>Create a New Quiz</h2>
  <input type="text" id="quizTitle" placeholder="Quiz Title">

  <div id="questionContainer">
    <div class="questionBlock">
      <textarea placeholder="Question"></textarea>
      <input type="text" placeholder="Answer">
    </div>
  </div>

  <button onclick="addQuestion()">Add Another Question</button>
  <button onclick="saveQuiz()">Save Quiz</button>

  <h3>My Quizzes</h3>
  <div id="myQuizzes"></div>
</div>

  <footer>
   <div class="footer-container">
     <p>Â© 2025 QuizHub | All rights reserved</p>
     <div class="social-links">
      <a href="#" title="Discord">Discord</a>
    </div>
   </div>
 </footer>

<script>
let myQuizzes = JSON.parse(localStorage.getItem('myQuizzes')) || [];
let globalQuizzes = JSON.parse(localStorage.getItem('globalQuizzes')) || [];

// Add new question input block
function addQuestion() {
  const container = document.getElementById('questionContainer');
  const div = document.createElement('div');
  div.classList.add('questionBlock');
  div.innerHTML = `
    <textarea placeholder="Question"></textarea>
    <input type="text" placeholder="Answer">
  `;
  container.appendChild(div);
}

// Save Quiz
function saveQuiz() {
  const title = document.getElementById('quizTitle').value.trim();
  if (!title) return alert("Quiz title is required!");

  const questionBlocks = document.querySelectorAll('#questionContainer .questionBlock');
  const questions = [];

  questionBlocks.forEach(block => {
    const question = block.querySelector('textarea').value.trim();
    const answer = block.querySelector('input').value.trim();
    if (question && answer) {
      questions.push({ question, answer });
    }
  });

  if (questions.length === 0) return alert("Add at least one question with an answer!");

  const profile = JSON.parse(localStorage.getItem('profile')) || {};
  const creator = profile.username || "Anonymous";

  const quiz = { title, questions, creator };
  myQuizzes.push(quiz);
  globalQuizzes.push(quiz);

  localStorage.setItem('myQuizzes', JSON.stringify(myQuizzes));
  localStorage.setItem('globalQuizzes', JSON.stringify(globalQuizzes));

  displayMyQuizzes();
  alert("Quiz saved!");
  resetForm();
}


// Display My Quizzes
function displayMyQuizzes() {
  const container = document.getElementById('myQuizzes');
  container.innerHTML = '';

  if(myQuizzes.length === 0){
    container.innerHTML = "<p>No quizzes yet. Create one above!</p>";
    return;
  }

  myQuizzes.forEach((quiz, index) => {
    const div = document.createElement('div');
    div.classList.add('card');

    div.innerHTML = `<h4>${quiz.title}</h4>`;

    // Display all questions
    if(quiz.questions && Array.isArray(quiz.questions)){
      quiz.questions.forEach((q,i)=>{
        div.innerHTML += `<p>Q${i+1}: ${q.question} | Answer: ${q.answer}</p>`;
      });
    }

    // Delete button
    const delBtn = document.createElement('button');
    delBtn.innerText = "Delete Quiz";
    delBtn.onclick = () => deleteQuiz(index);
    div.appendChild(delBtn);

    container.appendChild(div);
  });
}

// Delete Quiz
function deleteQuiz(index) {
  if (!confirm("Are you sure you want to delete this quiz?")) return;
  const deletedQuiz = myQuizzes.splice(index, 1)[0];
  localStorage.setItem('myQuizzes', JSON.stringify(myQuizzes));

  // Also remove from global quizzes
  globalQuizzes = globalQuizzes.filter(q => q.title !== deletedQuiz.title);
  localStorage.setItem('globalQuizzes', JSON.stringify(globalQuizzes));

  displayMyQuizzes();
}

// Reset Form
function resetForm() {
  document.getElementById('quizTitle').value = '';
  document.getElementById('questionContainer').innerHTML = `
    <div class="questionBlock">
      <textarea placeholder="Question"></textarea>
      <input type="text" placeholder="Answer">
    </div>
  `;
}

// Initialize
displayMyQuizzes();
</script>
</body>
</html>
