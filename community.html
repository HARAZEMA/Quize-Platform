<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Community - QuizHub</title>
<link rel="stylesheet" href="style.css">
<style>
/* Community Page Styles */
.container h2 {
  text-align: center;
  margin-bottom: 2rem;
  color: #0ff;
  text-shadow: 0 0 10px #0ff;
}

#commentForm {
  display: flex;
  flex-direction: column;
  margin-bottom: 2rem;
}

#commentForm input,
#commentForm textarea {
  padding: 0.8rem;
  margin-bottom: 1rem;
  border-radius: 8px;
  border: 1px solid #0ff;
  background: #022b3a;
  color: #c0f0ff;
}

#commentForm button {
  align-self: flex-start;
  padding: 0.6rem 1.2rem;
  border-radius: 8px;
  border: 1px solid #0ff;
  background: #011a27;
  color: #0ff;
  cursor: pointer;
  transition: all 0.3s ease;
}

#commentForm button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px #0ff, 0 0 30px #00f inset;
}

.comment-card {
  background: #011a27;
  padding: 1rem;
  margin-bottom: 1rem;
  border-radius: 10px;
  box-shadow: 0 0 10px #0ff;
  transition: all 0.3s ease-in-out;
}

.comment-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 0 20px #0ff, 0 0 40px #00f inset;
}

.comment-card p {
  margin-bottom: 0.3rem;
}
.comment-card .meta {
  font-size: 0.8rem;
  color: #a0f0ff;
}
.comment-card button {
  margin-top: 5px;
  padding: 0.3rem 0.6rem;
  font-size: 0.8rem;
}
</style>
</head>
<body>

<!-- Navbar -->
<nav>
  <a href="index.html">Home</a>
  <a href="myquiz.html">My Quizzes</a>
  <a href="global.html">Global Quizzes</a>
  <a href="profile.html">Profile</a>
  <a href="community.html">Community</a>
</nav>

<div class="container">
  <h2>Community Feedback</h2>

  <form id="commentForm">
    <input type="text" id="username" placeholder="Your Name (optional)">
    <textarea id="commentText" placeholder="Leave your feedback..."></textarea>
    <button type="button" onclick="addComment()">Submit Feedback</button>
  </form>

  <div id="commentsContainer"></div>
</div>

<footer>
  <div class="footer-container">
    <p>Â© 2025 QuizHub | All rights reserved</p>
    <div class="social-links">
      <a href="#" title="Discord">Discord</a>
    </div>
  </div>
</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCTQxhVWq6yugqmZdx93JApQD4ODru56D4",
    authDomain: "quizhub-d5b40.firebaseapp.com",
    databaseURL: "https://quizhub-d5b40-default-rtdb.firebaseio.com",
    projectId: "quizhub-d5b40",
    storageBucket: "quizhub-d5b40.firebasestorage.app",
    messagingSenderId: "635722320170",
    appId: "1:635722320170:web:6094dbf608de89510af653"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const commentsRef = ref(db, 'communityComments');

  const commentsContainer = document.getElementById('commentsContainer');

  // Display comments in real-time
  function displayComments() {
    onValue(commentsRef, snapshot => {
      const data = snapshot.val();
      commentsContainer.innerHTML = '';

      if (!data) {
        commentsContainer.innerHTML = '<p>No feedback yet. Be the first to comment!</p>';
        return;
      }

      Object.keys(data).forEach(key => {
        const commentData = data[key];
        const div = document.createElement('div');
        div.classList.add('comment-card');
        div.innerHTML = `
          <p>${commentData.text}</p>
          <p class="meta">By: ${commentData.username || "Anonymous"} | ${new Date(commentData.date).toLocaleString()}</p>
          <button onclick="deleteComment('${key}')">Delete</button>
        `;
        commentsContainer.appendChild(div);
      });
    });
  }

  // Add new comment
  window.addComment = function () {
    const text = document.getElementById('commentText').value.trim();
    const username = document.getElementById('username').value.trim();

    if (!text) return alert("Please write a comment first!");

    push(commentsRef, {
      text: text,
      username: username || "Anonymous",
      date: new Date().toISOString()
    });

    document.getElementById('commentText').value = '';
    document.getElementById('username').value = '';
  }

  // Delete comment
  window.deleteComment = function (key) {
    if (!confirm("Are you sure you want to delete this comment?")) return;
    remove(ref(db, `communityComments/${key}`));
  }

  // Initialize
  displayComments();
</script>

</body>
</html>
